---
title: Clase 02 - Setup de Laboratorio & Chirps Stack
date: 2024-09-19 12:20:00 -0500
categories: [clase 02, setup, chirp, jekyll, github]
tags: [tag1, tag2]     # TAG names should always be lowercase
header-includes:
    - \usepackage{pdfpages}
---

# Setup de Laboratorio

## General Guidelines: 

### VirtualBox installation and setup: 
- Habilitar la capacidad de virtualización en la BIOS ([Link](https://youtu.be/_59VZMPUikc?si=UeuweeHoEkiNtYu7)).
- Instalación del VirtualBox 7.0 (evitar la versión 7.1) ([Link](https://youtu.be/8mns5yqMfZk?si=jEs64Jkut8GvSA3z)).
- Instalación del VirtualBox Extension Pack ([Link](https://youtu.be/Y24bCLJSoyk?si=rBQl1fV3M_ilXz0Y)).
- Para cada máquina virtual, instalar el paquete VirtualBox Guest Additions ([Link](https://youtu.be/9up2oPu-hkA?si=qz5vqVTqpHr9gZz1)).

### Virtual Machine Creation 
- Descargar el instalador del sistema operativo Windows 10/11 en formato ISO ([Link](https://www.microsoft.com/software-download/windows10)).
- Descargar el instalador de Kali Linux en formato ISO ([Link](https://www.kali.org/get-kali/#kali-installer-images)).
- Realizar la instalación de ambas máquinas virtuales.

### Lab: Kali Linux vs Metasploitable 3 
- Kali Linux ([¿Qué es Kali Linux?](https://youtu.be/psyDZ9ytlwc?si=lIpT0xLrqnP-Is0H)).
- Metasploitable 3 ([¿Qué es Metasploitable?](https://github.com/rapid7/metasploitable3/wiki)).
- Network Setup entre Kali Linux & Metasploitable 3 ([Link](https://youtu.be/2Fkf6Kysh7I?si=vGCKk5PRc9iyzCx9)).

## The Kill Chain 

¿Qué es el Kill Chain? [(Link)](https://youtu.be/oCUrkc_0tmw?si=bypiWhaGtWzEOrIQ)

### Reconnaissance:

Gather information about the target.

| Passive | Protection measure |
|---------|---------|
| - Whois | - Limitar información pública |
| - Arin  | - Uso moderado de RRSS |
| - Google| - Modificar los mensajes de error de servicios que corren en el server |
| - Shodan | |
| - Job listings |  |
| - Company website | |


| - Active | Protection measure |
|----------|--------------------|
| - Nmap | Desactivar servicios/puertos que no se usen |
| - Port scanning | Honeypots |
| - Banner grabbing | Firewall |
| - Vulnerability |  IPS |
| | - Bloque de tráfico entrante proveniente de Tor & VPNs de terceros.

- Objetivo: Encontrar debilidades en la red o sistema

### Weaponization: 

Crear el ataque para explotar las debilidades encontradas 


| Ataque | Defensa |
|--------|---------|
| - Metasploit | - Patch management |
| - Exploit-DB | - Deshabilitación del Office Macros, Javascript, Browser plugins | 
| - Veil Framework | 
Metasploit Exploit-DB Veil Framework Social Engineering Toolkit Cain and Abel SQLMap Aircrack Maltego Web app Burp Suite
FratRAT | Defensa: Patch management Deshabilitación Office Macros Javascript Browser plugins Antivirus IPS Email security MFA
Audit logging | | :—- | :—- | 
Objetivo: Selección de armas basado en la etapa de Reconnaissance
Delivery: Entregar del exploit. 
| Websites Social media User input Email USB | Web filtering / DMS Filtering Phishing campaigns IPS/IDS DKIM / SPF Disabling USB |
| :—- | :—- | 
Exploitation: Weapon delivered, attack executed. 
| Buffer overflow SQL Injection Malware Client-side exploit (Javascript Hijack) | Data execution prevention (DEP) Anti-exploit
Sandbox | | :—- | :—- | 
Objetivo: Ganar acceso al sistema o a la red 
Installation: Payload injected after the exploit to gain better access. 
| Offensive Tools DLL Hijacking Meterpreter Remote Access Tools (RAT) Registry changes Powershell commands | Protección
limitada Linux: CHROOT Jail Windows: Disable Powershell Detección: UBA / EDR Respuesta: Seguimiento a incidencias (Device >
Aislamiento > Limpieza) Recovering: Restoration | | :—- | :—- | 
Command and Control: Control remoto del sistema. 
Network Segmentation
Micro Segmentation
NGFW: C&C Blocking
DNS Redirect (DBA, Fast Flux)
Application control (SSH, Telnet, Netcat, RDP / SSL packet inspection)
IoC (observed behavior)
Actions on Object (Post-exploitation): Attacker executes desired action 
Understanding motivations of the attacker
Most of the times is all about DATA EXFILTRATION 
Data leakage prevention (DLP)
User behavior analysis (UBA)
Other times is all about LATERAL MOVEMENT 
Network segmentation is important